Last updated: 2025-11-20

# Project Overview

## プロジェクト概要
- `cat-play-mml`は、Music Macro Language (MML) をテキストで入力し、音楽をリアルタイムで再生するWindows用CLIツールです。
- 簡単なMML文字列を引数に渡すだけで、すぐにドレミなどの音楽を鳴らすことができ、低レイテンシでバックグラウンド演奏も可能です。
- MMLパーサー、オーディオ生成、再生機能を通じて、音楽記述から演奏までを一貫して提供します。

## 技術スタック
- フロントエンド: CLI (コマンドラインインターフェース) を通じたユーザー操作を提供
- 音楽・オーディオ:
    - **Music Macro Language (MML)**: 音楽をテキストで記述するための言語として利用
    - **Nuked-OPM**: 音楽データから音声波形を生成するオーディオエンジンとして使用
    - **cpal**: Rust製のクロスプラットフォームオーディオライブラリで、音声の再生を担当
- 開発ツール:
    - **Rust**: プロジェクトの主要な開発言語
    - **Zig cc**: C/C++コンパイラとして、ビルド環境に利用（MingwやMsys2の代替）
    - **tree-sitter**: MMLテキストを解析し、抽象構文木（AST）に変換するためのパーサー生成ツール
- テスト:
    - **TDD agent**: 開発プロセスにおけるテスト駆動開発（TDD）に利用
- ビルドツール:
    - **cargo**: Rustプロジェクトのビルド、依存関係管理、インストールに使用
- 言語機能:
    - 特になし
- 自動化・CI/CD:
    - **GitHub Actions**: READMEファイルの自動生成など、継続的インテグレーション/デリバリーの自動化に利用
- 開発標準:
    - **.editorconfig**: 複数のエディタやIDE間でコードのスタイルを統一するための設定ファイル

## ファイル階層ツリー
```
📄 .editorconfig
📄 .gitignore
📁 .vscode/
  📊 extensions.json
  📊 settings.json
📄 Cargo.lock
📄 Cargo.toml
📄 LICENSE
📖 README.ja.md
📖 README.md
📄 _config.yml
📁 generated-docs/
📁 src/
  📄 app.rs
  📄 cli.rs
  📄 client_manager.rs
  📄 converter.rs
  📄 input.rs
  📄 main.rs
  📄 process_manager.rs
```

## ファイル詳細説明
- **`.editorconfig`**: コーディングスタイル（インデントサイズ、文字コードなど）を定義し、プロジェクト内のファイルの一貫性を保つための設定ファイルです。
- **`.gitignore`**: Gitによるバージョン管理の対象外とするファイルやディレクトリを指定します。ビルド生成物や一時ファイルなどが含まれます。
- **`.vscode/extensions.json`**: Visual Studio Codeを使用する際に推奨される拡張機能をリストアップします。
- **`.vscode/settings.json`**: Visual Studio Codeのワークスペース固有の設定を定義します。
- **`Cargo.lock`**: プロジェクトが依存するすべてのクレート（ライブラリ）の正確なバージョンと依存関係ツリーを記録し、再現可能なビルドを保証します。
- **`Cargo.toml`**: Rustプロジェクトのマニフェストファイルで、プロジェクト名、バージョン、著者情報、依存クレートなどを定義します。
- **`LICENSE`**: プロジェクトのライセンス情報（MIT License）が記述されています。
- **`README.ja.md`**: プロジェクトの目的、使い方、特徴などを日本語で説明する主要なドキュメントです。
- **`README.md`**: `README.ja.md`を元に自動生成された、プロジェクトの英語での説明書です。
- **`_config.yml`**: GitHub Pagesなどのサイト生成ツールで使用される設定ファイルです。
- **`generated-docs/`**: 自動生成されたドキュメントやレポートを格納するためのディレクトリです。
- **`src/app.rs`**: アプリケーションのコアロジックをカプセル化し、クライアントとサーバー間の協調やMML処理の全体的な流れを管理します。
- **`src/cli.rs`**: コマンドラインインターフェースの引数を解析し、ユーザーからの入力（MML文字列、コマンドオプションなど）を処理します。
- **`src/client_manager.rs`**: バックグラウンドで動作するサーバープロセスとの通信（MMLデータの送信、制御コマンドなど）を管理するクライアント側のロジックを提供します。
- **`src/converter.rs`**: MMLテキストからパーサーが生成した抽象構文木（AST）を、内部で利用される音楽データ構造やSMFなどの別形式に変換する処理を担います。
- **`src/input.rs`**: ユーザーが入力したMML文字列を処理する機能を提供します。コマンドライン引数からの直接入力や、将来的なファイルからの読み込みなどを想定しています。
- **`src/main.rs`**: プロジェクトのエントリポイントとなるファイルです。`cli.rs`で解析された引数に基づいて、アプリケーションの起動、MMLの演奏、サーバーの制御など、適切な処理を呼び出します。
- **`src/process_manager.rs`**: バックグラウンドで動作するサーバープロセス（オーディオ再生を行う）の起動、停止、シャットダウンなどのライフサイクルを管理します。

## 関数詳細説明
このプロジェクトでは、以下の主要な機能が内部的に関数群によって実現されています。具体的な関数名はプロジェクト情報に明記されていませんが、それぞれの役割は以下の通りです。

- **`main`関数**: プログラムのエントリポイントとして機能し、コマンドライン引数を解析し、それに応じた適切なアプリケーションロジック（MMLの演奏、サーバーの起動や停止など）を呼び出します。
- **CLI引数処理関数群**: コマンドラインから渡された引数をパースし、ユーザーが実行したいアクション（例：MMLの再生、サーバーのシャットダウン、停止）を特定します。
- **MML解析・変換関数群**: 入力されたMML文字列を`tree-sitter`を利用して解析し、抽象構文木（AST）を生成します。その後、そのASTをプロジェクト内で扱える中間的な音楽データ構造に変換します。
- **オーディオ生成・再生関数群**: 内部の音楽データ構造に基づいて、`Nuked-OPM`を使用して音声波形データを生成します。生成された波形データは`cpal`ライブラリを介して、PCのオーディオデバイスからリアルタイムで再生されます。
- **サーバー/クライアント通信関数群**: `cat-play-mml`コマンド（クライアント）がバックグラウンドで動作するサーバープロセスとMMLデータや制御コマンド（停止、シャットダウンなど）を送受信するための通信プロトコルとロジックを扱います。
- **プロセス管理関数群**: バックグラウンドで音楽再生を担当するサーバープロセスの起動、停止、およびシャットダウンといったライフサイクルイベントを管理します。

## 関数呼び出し階層ツリー
```
関数呼び出し階層を分析するための情報が提供されていません。

---
Generated at: 2025-11-20 07:03:28 JST
