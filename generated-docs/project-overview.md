Last updated: 2025-11-26

# Project Overview

## プロジェクト概要
- Music Macro Language (MML) を用いて、テキストからリアルタイムに音楽を再生するWindows向けCLIツールです。
- 文字列 "cde" のような簡単な入力で「ドレミ」といった音楽をすぐに演奏できる、シンプルかつ低レイテンシな体験を提供します。
- バックグラウンドでの演奏やサーバーモードにも対応し、他の作業を妨げることなく音楽を楽しむことが可能です。

## 技術スタック
- フロントエンド: CLIツールとして機能するため、特定のGUIフレームワークは使用せず、コマンドラインインターフェースを通じて操作されます。
- 音楽・オーディオ: MML（テキストベースの音楽記述言語）を解釈し、`cpal` (Rustのクロスプラットフォームオーディオライブラリ) と`Nuked-OPM` (FM音源エミュレーションライブラリ) を利用して音声波形を生成・再生します。中間表現としてStandard MIDIファイル(SMF)も活用されます。
- 開発ツール: 主に`Rust`言語で開発され、そのパッケージマネージャー兼ビルドツールである`cargo`を使用します。MMLの解析には`tree-sitter`パーサーフレームワークが用いられ、開発環境として`Windows`が主、`Linux`はテスト目的で利用されます。
- テスト: `TDD`（テスト駆動開発）のアプローチが採用されており、堅牢な開発プロセスを支えています。
- ビルドツール: Rustプロジェクトのビルド、依存関係管理には`cargo`が使われます。
- 言語機能: アプリケーションは`Rust`言語の安全性、並行処理、パフォーマンスに優れた特性を活かして開発されています。
- 自動化・CI/CD: GitHub ActionsがREADMEファイルの自動翻訳などに利用されていますが、プロジェクトのビルドやデプロイに関する具体的なCI/CDツールは明記されていません。
- 開発標準: `.editorconfig`ファイルを通じて、異なる開発環境間でのコードスタイルの一貫性を保つための標準が設定されています。

## ファイル階層ツリー
```
📄 .editorconfig
📄 .gitignore
📁 .vscode/
  📊 extensions.json
  📊 settings.json
📄 Cargo.lock
📄 Cargo.toml
📄 LICENSE
📖 README.ja.md
📖 README.md
📄 _config.yml
📁 generated-docs/
📁 issue-notes/
  📖 31.md
📁 src/
  📄 app.rs
  📄 cli.rs
  📄 client_manager.rs
  📄 converter.rs
  📄 input.rs
  📄 main.rs
```

## ファイル詳細説明
- `.editorconfig`: 異なるエディタやIDEを使用する開発者間で、インデントスタイルや文字コードなどのコーディング規約を統一するための設定ファイルです。
- `.gitignore`: Gitのバージョン管理から除外するファイルやディレクトリ（例: ビルド成果物、一時ファイルなど）を指定する設定ファイルです。
- `.vscode/extensions.json`: Visual Studio Codeプロジェクトで推奨される拡張機能のリストを定義し、開発環境のセットアップを容易にします。
- `.vscode/settings.json`: Visual Studio Codeプロジェクト固有の設定（例: フォーマッタ、リンターの設定）を定義するファイルです。
- `Cargo.lock`: `Cargo.toml`で指定された依存ライブラリの正確なバージョンを記録し、ビルドの再現性を保証します。
- `Cargo.toml`: Rustプロジェクトのマニフェストファイル。プロジェクト名、バージョン、著者、依存ライブラリなどが定義されています。
- `LICENSE`: このプロジェクトがMITライセンスの下で公開されていることを示すライセンス条項が記述されています。
- `README.ja.md`: プロジェクトの概要、インストール方法、使用方法、特徴などが日本語で記述された説明書です。
- `README.md`: `README.ja.md`の英語版であり、プロジェクトの国際的な情報提供を担う説明書です。
- `_config.yml`: GitHub Pagesで使用されるJekyllの構成ファイルで、ドキュメントサイトの生成設定を含みます。
- `generated-docs/`: 開発状況レポートなど、自動生成されたドキュメントを格納するためのディレクトリです。
- `issue-notes/31.md`: 特定の課題（Issue #31）に関する詳細なメモや検討事項を記述したファイルです。
- `src/app.rs`: アプリケーションのコアロジック、MMLデータの音楽データへの変換、オーディオ波形の生成、再生など、主要な機能が実装されているモジュールです。
- `src/cli.rs`: コマンドラインインターフェース（CLI）の引数解析と、それに応じた適切なコマンド（再生、停止、シャットダウンなど）の実行ロジックを扱います。
- `src/client_manager.rs`: アプリケーションがサーバーモードで動作する際のクライアント機能、具体的にはバックグラウンドサーバーへのMMLデータの送信、サーバーの起動、停止、シャットダウン要求などを管理します。
- `src/converter.rs`: MMLテキストを解析して得られた抽象構文木（AST）を、オーディオ再生に必要な音楽データ構造（中間表現）に変換するロジックが含まれています。
- `src/input.rs`: ユーザーからのMML文字列入力やコマンドライン引数など、アプリケーションへの入力を受け取り、処理する機能を提供します。
- `src/main.rs`: Rustアプリケーションのエントリーポイント。`cli.rs`で解析されたコマンドに基づいて、`app.rs`や`client_manager.rs`などの他のモジュールの機能を呼び出し、プログラム全体の実行フローを制御します。

## 関数詳細説明
このプロジェクトでは、以下の役割を持つ関数群が各モジュールで定義されています。具体的な関数の引数や戻り値は提供されていませんが、それぞれの機能範囲は以下の通りです。

- `src/main.rs`で定義される関数群:
    - アプリケーションの起動時に最初に実行されるエントリーポイントの関数です。コマンドライン引数を読み込み、それに応じてMMLの再生、サーバーの起動/停止/シャットダウンといった主要な処理を開始します。
- `src/cli.rs`で定義される関数群:
    - コマンドラインから入力された引数を解析し、ユーザーが何をしたいのか（例: MML文字列の再生、`--stop`コマンド、`--shutdown`コマンド）を判断します。解析結果に基づいて、適切な処理を呼び出す役割を担います。
- `src/client_manager.rs`で定義される関数群:
    - アプリケーションがバックグラウンドサーバーとして動作している場合に、クライアントからのMMLデータ送信を受け付けたり、サーバーへの停止やシャットダウンコマンドを管理したりする関数群です。サーバーとの通信プロトコルを処理します。
- `src/converter.rs`で定義される関数群:
    - MMLテキストを解析して得られた音楽の構造（ASTなど）を、最終的に音として再生できる形式（例: 中間表現、音声波形データ）に変換する役割を担います。MMLの記法を音楽的な情報に落とし込む変換ロジックが実装されています。
- `src/input.rs`で定義される関数群:
    - ユーザーがコマンドラインで入力したMML文字列やその他のコマンドを安全に受け取り、アプリケーションの内部処理に適した形式に整形する役割を持つ関数群です。入力のバリデーションなども含まれる可能性があります。
- `src/app.rs`で定義される関数群:
    - アプリケーションの中核を成すロジックを含む関数群です。変換されたMMLデータから実際の音声波形を生成し、それをオーディオデバイスを通じて再生する処理を主に担当します。音楽再生の具体的な手順がここに集約されています。

## 関数呼び出し階層ツリー
```
関数の呼び出し階層ツリーは、提供された情報からは分析できませんでした。

---
Generated at: 2025-11-26 07:03:31 JST
