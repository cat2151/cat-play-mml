Last updated: 2025-11-09

# Project Overview

## プロジェクト概要
- Music Macro Language (MML) を解析し、音楽を再生するCLIツールです。
- 文字列`cde`を入力するだけで、Windows上でリアルタイムに「ドレミ」を演奏します。
- シンプルな操作で低レイテンシの演奏を実現し、バックグラウンドでの再生も可能です。

## 技術スタック
- フロントエンド: CLIツールとしてRustで実装されており、ユーザーからのコマンドライン入力を受け付けます。
- 音楽・オーディオ: MMLの構文解析には`tree-sitter`、オーディオ生成には`Nuked-OPM`、音声出力にはRustの`cpal`ライブラリを使用しています。
- 開発ツール: 主に`Rust`言語と、C/C++コンパイラとして`Zig cc`が開発環境に利用されています。
- テスト: TDD（テスト駆動開発）アプローチを採用しており、Linux環境でのテスト実行も行われています。
- ビルドツール: Rustプロジェクトの標準ビルドツールである`Cargo`を使用しています。
- 言語機能: `Rust`の強力な型システムと安全性、並行処理能力を活かして開発されています。
- 自動化・CI/CD: `GitHub Actions`を利用して、ドキュメントの自動生成などのCI/CDプロセスが一部導入されています。
- 開発標準: コード品質の維持のため、Rustの公式フォーマッタやリンターの活用が推測されます。

## ファイル階層ツリー
```
📄 .editorconfig
📄 .gitignore
📁 .vscode/
  📊 extensions.json
  📊 settings.json
📄 Cargo.lock
📄 Cargo.toml
📖 IMPLEMENTATION_PLAN.md
📖 IMPLEMENTATION_SUMMARY.md
📄 LICENSE
📖 PHASE2_INVESTIGATION_REPORT.md
📖 PHASE2_STATUS.md
📖 QUICK_REFERENCE.md
📖 README.ja.md
📖 README.md
📖 TESTING_GUIDE.md
📄 _config.yml
📁 generated-docs/
📁 issue-notes/
  📖 11.md
  📖 13.md
  📖 15.md
  📖 17.md
  📖 19.md
  📖 21.md
📁 src/
  📄 app.rs
  📄 cli.rs
  📄 client_manager.rs
  📄 converter.rs
  📄 input.rs
  📄 main.rs
  📄 process_manager.rs
  📄 temp_file.rs
```

## ファイル詳細説明
*   `.editorconfig`: 各エディタでコードのスタイル（インデント、改行コードなど）を統一するための設定ファイルです。
*   `.gitignore`: Gitのバージョン管理から除外するファイルやディレクトリを指定します。
*   `.vscode/`: Visual Studio Codeエディタ用の設定ファイル群を格納します。
    *   `extensions.json`: プロジェクト推奨のVS Code拡張機能をリストアップします。
    *   `settings.json`: プロジェクト固有のVS Codeエディタ設定を定義します。
*   `Cargo.lock`: `Cargo.toml`で指定された依存関係の具体的なバージョンをロックするファイルです。
*   `Cargo.toml`: Rustプロジェクトのマニフェストファイル。プロジェクト名、バージョン、依存クレートなどを定義します。
*   `IMPLEMENTATION_PLAN.md`: 実装計画に関するドキュメントです。
*   `IMPLEMENTATION_SUMMARY.md`: 実装の概要をまとめたドキュメントです。
*   `LICENSE`: プロジェクトのライセンス情報（MIT License）を記載しています。
*   `PHASE2_INVESTIGATION_REPORT.md`: 第2フェーズの調査報告書です。
*   `PHASE2_STATUS.md`: 第2フェーズの進捗状況を記載したドキュメントです。
*   `QUICK_REFERENCE.md`: プロジェクトに関するクイックリファレンス情報です。
*   `README.ja.md`: プロジェクトの日本語版説明書です。
*   `README.md`: プロジェクトの英語版説明書です。
*   `TESTING_GUIDE.md`: テストに関するガイドラインです。
*   `_config.yml`: Jekyllなどの静的サイトジェネレータで使用される設定ファイルです。
*   `generated-docs/`: 自動生成されたドキュメントを格納するディレクトリです。
*   `issue-notes/`: 開発中の課題や検討事項に関するメモを格納するディレクトリです。
    *   `11.md`, `13.md`, `15.md`, `17.md`, `19.md`, `21.md`: 特定の課題に関連するメモファイルです。
*   `src/`: プロジェクトの主要なソースコードが格納されています。
    *   `app.rs`: アプリケーションの主要なビジネスロジックや、MMLの解析・再生、サーバーモードの制御など、コア機能を提供します。
    *   `cli.rs`: コマンドラインインターフェース（CLI）の定義と、ユーザーからの引数を解析するロジックを扱います。
    *   `client_manager.rs`: バックグラウンドで動作するサーバーと、MMLを送信するクライアント間の通信を管理する機能を提供します。
    *   `converter.rs`: MML文字列をプログラムが扱える音楽データ構造に変換するパーサーと、その後のオーディオ生成処理を担当します。
    *   `input.rs`: ユーザーからのMML入力や、サーバーへのコマンド送信など、入力処理に関連する機能を提供します。
    *   `main.rs`: プログラムのエントリーポイントであり、CLI引数の解析、アプリケーションの初期化、主要な処理の呼び出しを行います。
    *   `process_manager.rs`: バックグラウンドサーバープロセスの起動、停止、シャットダウンといったライフサイクル管理を行います。
    *   `temp_file.rs`: プロセス間通信などに使用される一時ファイルの作成や削除などの管理機能を提供します。

## 関数詳細説明
プロジェクト情報に具体的な関数名やシグネチャが記載されていないため、各ファイルが担当する主要な機能について、どのような役割の関数が含まれるか説明します。

*   `main`関数 (`src/main.rs`): プログラムの開始点となる関数です。コマンドライン引数を解析し、それに応じてアプリケーションの動作（MML再生、サーバー起動、サーバー停止など）を決定し、適切な処理を呼び出します。
*   アプリケーション制御関数群 (`src/app.rs`): MMLの再生処理、サーバーモードでの動作制御、オーディオデータの生成と出力など、アプリケーションの中核となる機能を提供する関数群です。
*   CLI解析関数群 (`src/cli.rs`): コマンドライン引数を定義し、ユーザーが入力した引数を解析して、アプリケーションが利用しやすい形式に変換する関数群です。
*   クライアント管理関数群 (`src/client_manager.rs`): サーバーが稼働している場合に、クライアントからのMMLデータやコマンドを受け取り、サーバーへ転送するなどのプロセス間通信を管理する関数群です。
*   MML変換関数群 (`src/converter.rs`): MML文字列を構文解析し、内部的な音楽データ構造（中間表現）に変換する関数や、その音楽データからオーディオ波形を生成する関数群です。
*   入力処理関数群 (`src/input.rs`): ユーザーからのMML文字列入力を処理したり、アプリケーションの挙動を制御するための各種コマンドを受け付けたりする機能を持つ関数群です。
*   プロセス管理関数群 (`src/process_manager.rs`): バックグラウンドで実行されるサーバープロセスを起動、停止、または完全にシャットダウンするための機能を提供する関数群です。
*   一時ファイル管理関数群 (`src/temp_file.rs`): アプリケーションが実行中に一時的に必要とするファイルを安全に作成し、利用後に適切にクリーンアップする機能を持つ関数群です。

## 関数呼び出し階層ツリー
```
関数呼び出し階層を分析できませんでした。
しかし、プロジェクトの主要な処理フローは以下の通りと推測されます：
1. `main`関数がプログラムのエントリーポイントとして実行されます。
2. `main`関数は`cli`モジュールの関数を呼び出してコマンドライン引数を解析します。
3. 解析された引数に基づき、`app`モジュールの主要な関数が呼び出され、MMLの再生、サーバーの起動/停止/シャットダウンなどの処理が実行されます。
4. MML再生の場合、`converter`モジュールの関数がMMLを音楽データに変換し、オーディオを生成します。
5. サーバーモードの場合、`client_manager`と`process_manager`が連携し、バックグラウンドでのMML受付と再生、プロセス管理を行います。
6. `temp_file`モジュールの関数は、必要に応じて一時ファイルの作成と管理を行います。

---
Generated at: 2025-11-09 22:28:35 JST
