Last updated: 2025-11-17

# Project Overview

## プロジェクト概要
- Music Macro Language (MML) をテキスト入力で再生するWindows用CLIツールです。
- 文字列 "cde" のようなMMLをコマンドライン引数として渡すだけで、ドレミの音をリアルタイムで演奏します。
- 低レイテンシでの音楽再生と、バックグラウンドでの演奏が可能なサーバーモードを特徴としています。

## 技術スタック
- フロントエンド: CLI (Command Line Interface) - コマンドラインを通じてユーザーと対話します。
- 音楽・オーディオ:
    - Nuked-OPM: 音源生成に使用される可能性のあるライブラリ。
    - cpal: Rust製のクロスプラットフォームオーディオライブラリで、音声出力に使用されます。
    - Music Macro Language (MML): 音楽をテキストで記述するための言語としてパース・再生されます。
- 開発ツール:
    - Rust: プロジェクトの主要なプログラミング言語です。
    - Zig cc: クロスコンパイルや特定のCライブラリとの連携に使用されるコンパイラツールチェーン。
    - tree-sitter: MMLテキストを解析し、抽象構文木 (AST) に変換するためのパーサー生成ツール。
- テスト:
    - Linux runner + ALSA SDK: ヘッドレス環境でのTDD (テスト駆動開発) のためにLinux上で利用される環境およびオーディオSDK。
- ビルドツール:
    - Cargo: Rustのビルドシステムとパッケージマネージャー。
- 言語機能:
    - Rust: 安全性、並行性、パフォーマンスに優れたシステムプログラミング言語です。
- 自動化・CI/CD:
    - GitHub Actions: READMEファイルの自動翻訳など、CI/CDパイプラインの一部として使用されます。
- 開発標準:
    - .editorconfig: 異なるエディタやIDE間でコードのスタイルとフォーマットを統一するための設定ファイル。

## ファイル階層ツリー
```
📄 .editorconfig
📄 .gitignore
📁 .vscode/
  📊 extensions.json
  📊 settings.json
📄 Cargo.lock
📄 Cargo.toml
📖 IMPLEMENTATION_PLAN.md
📖 IMPLEMENTATION_SUMMARY.md
📄 LICENSE
📖 PHASE2_INVESTIGATION_REPORT.md
📖 PHASE2_STATUS.md
📖 QUICK_REFERENCE.md
📖 README.ja.md
📖 README.md
📖 TESTING_GUIDE.md
📄 _config.yml
📁 generated-docs/
📁 issue-notes/
  📖 11.md
  📖 13.md
  📖 15.md
  📖 17.md
  📖 19.md
  📖 21.md
  📖 23.md
  📖 25.md
  📖 27.md
  📖 29.md
📁 src/
  📄 app.rs
  📄 cli.rs
  📄 client_manager.rs
  📄 converter.rs
  📄 input.rs
  📄 main.rs
  📄 process_manager.rs
```

## ファイル詳細説明
- **`.editorconfig`**: コードエディタが、改行コード、インデントスタイル、文字エンコーディングなどの基本的なコードスタイルを自動的に統一するための設定ファイルです。
- **`.gitignore`**: Gitのバージョン管理システムが無視すべきファイルやディレクトリのパターンを定義するファイルです。ビルド成果物や一時ファイルなどが含まれます。
- **`.vscode/extensions.json`**: VS Code推奨拡張機能のリストです。プロジェクトに関わる開発者が一貫した開発環境を構築するのに役立ちます。
- **`.vscode/settings.json`**: VS Codeのワークスペース固有の設定ファイルです。インデントサイズやリンターの設定などが含まれることがあります。
- **`Cargo.lock`**: Rustの依存関係管理ツールであるCargoが、プロジェクトの依存クレートとその正確なバージョンを記録するファイルです。これにより、ビルドの一貫性が保証されます。
- **`Cargo.toml`**: Rustプロジェクトのマニフェストファイルです。プロジェクト名、バージョン、著者情報、依存クレート、ビルド設定などが記述されています。
- **`IMPLEMENTATION_PLAN.md`**: 実装計画に関するドキュメントです。プロジェクトの進め方や手順が記述されている可能性があります。
- **`IMPLEMENTATION_SUMMARY.md`**: 実装の概要や結果をまとめたドキュメントです。
- **`LICENSE`**: プロジェクトのライセンス情報 (MIT License) が記述されたファイルです。
- **`PHASE2_INVESTIGATION_REPORT.md`**: プロジェクトの第2フェーズにおける調査報告書です。
- **`PHASE2_STATUS.md`**: プロジェクトの第2フェーズの現状に関するドキュメントです。
- **`QUICK_REFERENCE.md`**: クイックリファレンスガイドです。特定の情報に素早くアクセスできるようまとめられています。
- **`README.ja.md`**: プロジェクトの概要、インストール方法、使い方などが日本語で記述された説明書です。
- **`README.md`**: プロジェクトの概要、インストール方法、使い方などが英語で記述された説明書です。
- **`TESTING_GUIDE.md`**: テストに関するガイドラインや手順が記述されたドキュメントです。
- **`_config.yml`**: GitHub Pagesなどのサイト生成設定ファイルです。
- **`generated-docs/`**: 自動生成されたドキュメントを格納するディレクトリです。
- **`issue-notes/`**: 開発中の特定の問題や検討事項に関するメモを格納するディレクトリです。
- **`src/app.rs`**: アプリケーションの中核となるロジックや状態管理を担うモジュールです。
- **`src/cli.rs`**: コマンドライン引数の解析や、CLI固有のロジックを処理するモジュールです。
- **`src/client_manager.rs`**: クライアントとサーバー間の通信を管理し、音楽データの送信などを担当するモジュールです。
- **`src/converter.rs`**: MMLテキストを内部の音楽データ構造やオーディオ波形データに変換するロジックを持つモジュールです。
- **`src/input.rs`**: ユーザーからの入力（MML文字列など）を処理するモジュールです。
- **`src/main.rs`**: プロジェクトのエントリポイントです。アプリケーションの起動と主要な流れを定義します。
- **`src/process_manager.rs`**: バックグラウンドで動作するサーバープロセスなどの管理を担当するモジュールです。

## 関数詳細説明
提供されたプロジェクト情報には具体的な関数名やシグネチャの詳細が含まれていないため、ハルシネーションを避けるため、各ファイルの役割に基づいて想定される一般的な関数の役割について記述します。

- **`src/main.rs`**:
    - **`main`**: アプリケーションのエントリポイント。コマンドライン引数の処理を開始し、クライアントまたはサーバーモードを初期化します。
- **`src/app.rs`**:
    - **`run`**: アプリケーションの主要な実行ロジックをカプセル化し、コマンドに応じてMMLの解析、オーディオ生成、再生処理を連携させます。
- **`src/cli.rs`**:
    - **`parse_args`**: コマンドライン引数を解析し、実行モード（演奏、停止、シャットダウン、サーバー起動）とMML文字列を抽出します。引数: `std::env::Args`、戻り値: 解析されたオプションとMMLデータ。
- **`src/client_manager.rs`**:
    - **`send_mml`**: 実行中のサーバープロセスにMMLデータを送信します。引数: MML文字列、戻り値: 送信結果。
    - **`send_command`**: サーバーに対して停止やシャットダウンなどの制御コマンドを送信します。引数: コマンドの種類、戻り値: コマンド実行結果。
- **`src/converter.rs`**:
    - **`mml_to_audio_data`**: MML文字列を解析し、再生可能なオーディオデータ（波形データや中間表現）に変換します。引数: MML文字列、戻り値: オーディオデータ。
- **`src/input.rs`**:
    - **`get_mml_from_args`**: コマンドライン引数からMML文字列を安全に取得します。引数: `Vec<String>` (引数のリスト)、戻り値: `Option<String>` (MML文字列またはNone)。
- **`src/process_manager.rs`**:
    - **`start_server`**: バックグラウンドでサーバープロセスを起動します。引数: なし、戻り値: サーバー起動結果。
    - **`is_server_running`**: サーバープロセスが現在実行中であるかを確認します。引数: なし、戻り値: `bool` (実行中であればtrue)。
    - **`shutdown_server`**: 実行中のサーバープロセスを停止させます。引数: なし、戻り値: シャットダウン結果。

## 関数呼び出し階層ツリー
```
関数呼び出し階層を分析できませんでした。

---
Generated at: 2025-11-17 07:03:15 JST
